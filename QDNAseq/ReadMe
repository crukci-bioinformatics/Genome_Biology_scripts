##### Steps to create segmented copy number files:

-> Run bowtie aligned bam files through QDNAseq script (see submit_qdnaseq.sh).
-> Extract centromeres from the GRCh37 cytoband file from UCSC as a BED file (see b37_centromeres.bed)
-> Extract 100kb bin annotations from QDNAseq reference data objects in tab-delimited format (see extractBinAnnotations.R)
-> Used Bedtools to intersect the bins within centromeres and extract those that QDNAseq marks as not to be used (see ‘use’ column). This results in the bin100.centromeres.txt file.
-> Run ruby script for converting copy number file from QDNAseq to one in which consecutive bins within same segment are collapsed into single row, allowing for up to a certain number of missing values (NAs), adding the chromosome arm and excluding the centromere.

#### How to run:

-> collapse_segmented_copy_number.rb SampleName SampleName.binSize100.copyNumber.txt bin100.centromeres.txt > SampleName.binSize100.segmentedCopyNumber.txt

-> Rscript plot_copy_number.R SampleName SampleName.binSize100.copyNumber.txt SampleName.binSize100.segmentedCopyNumber.txt SampleName.binSize100.pdf


#### Script to apply scaling correction based on the number of HindIII restriction sites in each of the windows used by QDNAseq

-> Use HindIII digest file generated by HiCUP for the locations of the HindIII sites and annotated bins extracted from the QDNAseq (binAnnotations100.rds) to create a file containing counts of the number of HindIII sites within each bin (bin100.hindIII.txt)

-> Run apply_restriction_site_correction.R to correct the copy number profile output by QDNAseq.
